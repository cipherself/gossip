<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>gossip.core documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Gossip</span> <span class="project-version">0.1.0</span></span></a></h1></div><div class="sidebar primary"><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gossip</span></div></div></li><li class="depth-2 branch current"><a href="gossip.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><a href="gossip.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="gossip.core.html#var-c"><div class="inner"><span>c</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-create-node"><div class="inner"><span>create-node</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-forward"><div class="inner"><span>forward</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-forward-prob-accept"><div class="inner"><span>forward-prob-accept</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-get-id"><div class="inner"><span>get-id</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-gossip"><div class="inner"><span>gossip</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-handle-message"><div class="inner"><span>handle-message</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-handle-receive-forward"><div class="inner"><span>handle-receive-forward</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-handle-receive-gossip"><div class="inner"><span>handle-receive-gossip</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-handle-receive-heartbeat"><div class="inner"><span>handle-receive-heartbeat</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-handle-receive-initial"><div class="inner"><span>handle-receive-initial</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-handle-receive-remove"><div class="inner"><span>handle-receive-remove</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-handle-receive-replace"><div class="inner"><span>handle-receive-replace</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-my-pool"><div class="inner"><span>my-pool</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-post-send-initial"><div class="inner"><span>post-send-initial</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-schedule-heartbeat-dec"><div class="inner"><span>schedule-heartbeat-dec</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-schedule-heartbeat-send"><div class="inner"><span>schedule-heartbeat-send</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-send-heartbeat"><div class="inner"><span>send-heartbeat</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-send-initial"><div class="inner"><span>send-initial</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-send-remove"><div class="inner"><span>send-remove</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-send-replace"><div class="inner"><span>send-replace</span></div></a></li><li class="depth-1"><a href="gossip.core.html#var-unsubscribe"><div class="inner"><span>unsubscribe</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">gossip.core</h1><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var-c"><h3>c</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-create-node"><h3>create-node</h3><div class="usage"><code>(create-node ip port &amp; {:keys [in-view partial-view heartbeat-counter forward-counters received-messages], :or {in-view [], partial-view [], heartbeat-counter 5, forward-counters {}, received-messages #{}}})</code></div><div class="doc"><pre class="plaintext">Create a node that will be part of the Gossip network.
</pre></div></div><div class="public anchor" id="var-forward"><h3>forward</h3><div class="usage"><code>(forward socket subscriber-id node-id)</code></div><div class="doc"><pre class="plaintext">Send a ForwardSubscription message containing the subscriber-id to a node.
</pre></div></div><div class="public anchor" id="var-forward-prob-accept"><h3>forward-prob-accept</h3><div class="usage"><code>(forward-prob-accept socket forwarded-to-ref subscriber-id)</code></div><div class="doc"><pre class="plaintext">Accept a ForwardSubscription request with probablity 
(p = 1 / 1+ size of partial-view) or forward it to a
random node in the partial-view and update the 
forward-counters map.</pre></div></div><div class="public anchor" id="var-get-id"><h3>get-id</h3><div class="usage"><code>(get-id node)</code></div><div class="doc"><pre class="plaintext">Get the id of a node map e.g. {:ip &quot;192.168.1.1&quot; :port 1024} 
as a string &quot;ip:port&quot;.</pre></div></div><div class="public anchor" id="var-gossip"><h3>gossip</h3><div class="usage"><code>(gossip socket gossiper-ref message)</code></div><div class="doc"><pre class="plaintext">Send a message to all nodes in the partial-view.
</pre></div></div><div class="public anchor" id="var-handle-message"><h3>handle-message</h3><div class="usage"><code>(handle-message socket receiving-node-ref pkt)</code></div><div class="doc"><pre class="plaintext">Handle received messages.
</pre></div></div><div class="public anchor" id="var-handle-receive-forward"><h3>handle-receive-forward</h3><div class="usage"><code>(handle-receive-forward socket forwarded-to-ref subscriber-id)</code></div><div class="doc"><pre class="plaintext">Handle a ForwardSubscription request, if the request has been received more than
10 times, simply discard the thread.</pre></div></div><div class="public anchor" id="var-handle-receive-gossip"><h3>handle-receive-gossip</h3><div class="usage"><code>(handle-receive-gossip socket receiving-node-ref message)</code></div><div class="doc"><pre class="plaintext">If the node has received the message before, don&apos;t do anything.
If it&apos;s the first time that the node has received the message,
add the message to `received-messages&apos; and gossip it.</pre></div></div><div class="public anchor" id="var-handle-receive-heartbeat"><h3>handle-receive-heartbeat</h3><div class="usage"><code>(handle-receive-heartbeat receiving-node-ref)</code></div><div class="doc"><pre class="plaintext">Update the heartbeat-counter.
</pre></div></div><div class="public anchor" id="var-handle-receive-initial"><h3>handle-receive-initial</h3><div class="usage"><code>(handle-receive-initial socket receiving-node-ref subscriber-id)</code></div><div class="doc"><pre class="plaintext">Forward subscriber-id to all nodes in receiving-node&apos;s partial-view.
Forward `c&apos; additional copies of subscriber-id 
to random nodes in receiving-node&apos;s partial-view.
Add subscriber id to receiving-node&apos;s in-view.</pre></div></div><div class="public anchor" id="var-handle-receive-remove"><h3>handle-receive-remove</h3><div class="usage"><code>(handle-receive-remove receiving-node-ref to-remove-id)</code></div><div class="doc"><pre class="plaintext">
</pre></div></div><div class="public anchor" id="var-handle-receive-replace"><h3>handle-receive-replace</h3><div class="usage"><code>(handle-receive-replace receiving-node-ref original-id surrogate-id)</code></div><div class="doc"><pre class="plaintext">
</pre></div></div><div class="public anchor" id="var-my-pool"><h3>my-pool</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-post-send-initial"><h3>post-send-initial</h3><div class="usage"><code>(post-send-initial subscriber-ref contact-id)</code></div><div class="doc"><pre class="plaintext">Add contact-id to subscriber&apos;s partial-view.
</pre></div></div><div class="public anchor" id="var-schedule-heartbeat-dec"><h3>schedule-heartbeat-dec</h3><div class="usage"><code>(schedule-heartbeat-dec socket node-ref interval)</code></div><div class="doc"><pre class="plaintext">Decrease the value of the heartbeat-counter after every &quot;interval&quot;,
if the counter reaches zero, send an InitialSubscription request to
a random node from the partial-view.</pre></div></div><div class="public anchor" id="var-schedule-heartbeat-send"><h3>schedule-heartbeat-send</h3><div class="usage"><code>(schedule-heartbeat-send socket sender-ref interval)</code></div><div class="doc"><pre class="plaintext">Send a heartbeat to all nodes in the partial-view after every &quot;interval&quot;.
</pre></div></div><div class="public anchor" id="var-send-heartbeat"><h3>send-heartbeat</h3><div class="usage"><code>(send-heartbeat socket node-id)</code></div><div class="doc"><pre class="plaintext">
</pre></div></div><div class="public anchor" id="var-send-initial"><h3>send-initial</h3><div class="usage"><code>(send-initial socket subscriber-ref contact-id)</code></div><div class="doc"><pre class="plaintext">Send an initial subscription message to a contact node.
</pre></div></div><div class="public anchor" id="var-send-remove"><h3>send-remove</h3><div class="usage"><code>(send-remove socket node-id)</code></div><div class="doc"><pre class="plaintext">
</pre></div></div><div class="public anchor" id="var-send-replace"><h3>send-replace</h3><div class="usage"><code>(send-replace socket node-id surrogate-id)</code></div><div class="doc"><pre class="plaintext">
</pre></div></div><div class="public anchor" id="var-unsubscribe"><h3>unsubscribe</h3><div class="usage"><code>(unsubscribe socket unsubscriber-ref)</code></div><div class="doc"><pre class="plaintext">
</pre></div></div></div></body></html>